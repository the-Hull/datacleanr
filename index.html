<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive and Reproducible Data Cleaning • datacleanr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Interactive and Reproducible Data Cleaning">
<meta property="og:description" content="Flexible and efficient cleaning of data with interactivity. datacleanr facilitates best practices in data analyses and reproducibility with built-in features and by translating interactive/manual operations to code. The package is designed for interoperability, and so seamlessly fits into reproducible analyses pipelines in R.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">datacleanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/the-Hull/datacleanr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="datacleanr-">datacleanr <img src="reference/figures/dcr_logo.png" align="right" width="150"><a class="anchor" aria-label="anchor" href="#datacleanr-"></a>
</h1></div>
<!-- badges: start -->
<!-- [![CRAN status](https://www.r-pkg.org/badges/version/datacleanr)](https://CRAN.R-project.org/package=datacleanr) -->
<!-- [![Travis build status](https://travis-ci.org/the-Hull/datacleanr.svg?branch=master)](https://travis-ci.org/the-Hull/datacleanr) -->

<p><code>datacleanr</code> is a flexible and efficient tool for <strong>interactive</strong> data cleaning, and is inherently interoperable, as it seamlessly integrates into <strong>reproducible</strong> data analyses pipelines in <code>R</code>.</p>
<p>It can deal with nested <strong>tabular</strong>, as well as <strong>spatial</strong> and <strong>time series</strong> data.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The latest release on CRAN can be installed using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"datacleanr"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of <code>datacleanr</code> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"the-hull/datacleanr"</span><span class="op">)</span></span></code></pre></div>
<p><strong>If you are using macOS, please make sure you have <code>XQuartz</code> installed, especially if you’ve recently updated your system.</strong> <strong>See these instructions here: <a href="https://CRAN.R-project.org/bin/macosx/" class="external-link uri">https://CRAN.R-project.org/bin/macosx/</a></strong></p>
<p>**In case the package installation fails due to a compilation error from <code>magick</code>, please try installing the dev headers for <code>magick</code> with <code>sudo apt-get install libmagick++-dev</code>. Also see this <a href="https://github.com/the-Hull/datacleanr/issues/13" class="external-link">gh issue</a>.</p>
</div>
<div class="section level2">
<h2 id="design">Design<a class="anchor" aria-label="anchor" href="#design"></a>
</h2>
<p><code>datacleanr</code> is developed using the <a href="https://shiny.rstudio.com/" class="external-link">shiny</a> package, and relies on informative summaries, visual cues and interactive data selection and annotation. All data-altering operations are documented, and converted to valid <code>R</code> code (<strong>reproducible recipe</strong>), that can be copied, sent to an active <code>RStudio</code> script, or saved to disk.</p>
<p>There are <strong>four tabs</strong> in the app for these tasks:</p>
<ul>
<li>
<strong>Set-up &amp; Overview</strong>: define nesting structure based on (multiple) groups.</li>
<li>
<strong>Filtering</strong>: use <code>R</code> expression to filter/subset data.</li>
<li>
<strong>Visual Cleaning and Annotating</strong>: generate bivarirate (time series) plots and maps, as well as highlight and annotate individual observations. Cycle through nested groups to expedite exploration and cleaning. Histograms of original vs. ‘cleaned’ data can be generated.</li>
<li>
<strong>Extract</strong>: generate reproducible recipe and define outputs. <strong><code>dcr_app</code> also returns all intermediate and final outputs invisibly to the active <code>R</code> session for later use (e.g. when batch processing)</strong>
</li>
</ul>
<p>Note, maps require columns <code>lon</code> and <code>lat</code> (X and Y) in decimal degrees in the data set to render.</p>
</div>
<div class="section level2">
<h2 id="additional-features">Additional features<a class="anchor" aria-label="anchor" href="#additional-features"></a>
</h2>
<ul>
<li>
<strong>Grouping</strong>: the grouping defined in the “Set-up and Overview” tab is carried forward through the app. These groups can be used to cycle through nested/granular data, and considerably speed up exploration and cleaning. These groups are also available for filtering (Filtering tab), where filter expressions can be scoped to group level (i.e. no groups, individual, all groups).</li>
<li>
<strong>Interoperability</strong>: when a logical (<code>TRUE</code>\<code>FALSE</code>) column named <code>.dcrflag</code> is present, corresponding observations are rendered with different symbols in plots and maps. Use this feature to validate or cross-check external quality control or outlier flagging methods.</li>
<li>
<strong>Batching</strong>: If data sets are too large, or too deeply nested (e.g. individual, plot, site, region, etc.), we recommend a split-combine approach to expedite the processing.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare data into species sub-sets</span></span>
<span><span class="va">iris_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span>,</span>
<span>                    f <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span><span class="co"># run for each species</span></span>
<span><span class="va">dcr_iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">iris_split</span>, </span>
<span>                   <span class="kw">function</span><span class="op">(</span><span class="va">split</span><span class="op">)</span><span class="op">{</span></span>
<span>                       <span class="fu">datacleanr</span><span class="fu">::</span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="va">split</span><span class="op">)</span></span>
<span>                   <span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>The documentation for (<code>?dcr_app()</code>) explains the basic use and all features. Throughout the app, there are conveniently-placed help links that provide details on features.</p>
</div>
<div class="section level2">
<h2 id="demonstration">Demonstration<a class="anchor" aria-label="anchor" href="#demonstration"></a>
</h2>
<p>Launch <code>datacleanr</code>’s interactive app with <code><a href="reference/dcr_app.html">dcr_app()</a></code>. The following examples demonstrate basic use and highlight features across the four app tabs.</p>
<div class="section level3">
<h3 id="id_1-set-up--overview">1. Set-up &amp; Overview<a class="anchor" aria-label="anchor" href="#id_1-set-up--overview"></a>
</h3>
<p>Define the grouping structure (used throughout app for scoping filters and plotting), and generate an informative overview.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/the-Hull/datacleanr" class="external-link">datacleanr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># group by species</span></span>
<span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/the-Hull/datacleanr/master/man/figures/readme_setup.gif" width="1000" align="center"></p>
</div>
<div class="section level3">
<h3 id="id_2-filtering">2. Filtering<a class="anchor" aria-label="anchor" href="#id_2-filtering"></a>
</h3>
<p>Add/Remove filter statement boxes, and apply (valid) expressions - either to the entire data set, or scoped to individual groups. Filtering relies on <code>R</code> expressions passed to <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter()</a></code>, so, for example, valid statements for <code>iris</code> are:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>    <span class="va">Species</span> <span class="op">==</span> <span class="st">'setosa'</span></span>
<span>    <span class="va">Species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'setosa'</span>,<span class="st">'versicolor'</span><span class="op">)</span></span>
<span>    <span class="va">Sepal.Width</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Sepal.Width</span>, <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p>Any function returning a logical vector (i.e. <code>TRUE</code>/<code>FALSE</code>), can be employed here!</p>
<p><img src="https://raw.githubusercontent.com/the-Hull/datacleanr/master/man/figures/readme_filter.gif" width="1000" align="center"></p>
</div>
<div class="section level3">
<h3 id="id_3-visualizing-and-annotating">3. Visualizing and annotating<a class="anchor" aria-label="anchor" href="#id_3-visualizing-and-annotating"></a>
</h3>
<p>Interactive visualization allow seamless scrolling, panning and zooming to select and annotate individual observations (or sections with lasso/box select tool). Show and hide groups using the group selection table (left) or the legend (right).</p>
<div class="section level4">
<h4 id="id_31-general-highlighting-and-annotating">3.1 General highlighting and annotating<a class="anchor" aria-label="anchor" href="#id_31-general-highlighting-and-annotating"></a>
</h4>
<p><img src="https://raw.githubusercontent.com/the-Hull/datacleanr/master/man/figures/readme_select.gif" width="1000" align="center"></p>
</div>
<div class="section level4">
<h4 id="id_32-using-dcrflag-to-interface-with-external-qaqc">3.2 Using <code>.dcrflag</code> to interface with external QA/QC<a class="anchor" aria-label="anchor" href="#id_32-using-dcrflag-to-interface-with-external-qaqc"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/the-Hull/datacleanr" class="external-link">datacleanr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">iris_mod</span> <span class="op">&lt;-</span> <span class="va">iris</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># .dcrflag provides additional visual cue in visualization tab</span></span>
<span>  <span class="co"># based on TRUE/FALSE </span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>.dcrflag <span class="op">=</span> <span class="va">Sepal.Width</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">Sepal.Width</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="va">iris_mod</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/the-Hull/datacleanr/master/man/figures/readme_select_dcrflag.gif" width="1000" align="center"></p>
</div>
<div class="section level4">
<h4 id="id_33-time-series">3.3 Time Series<a class="anchor" aria-label="anchor" href="#id_33-time-series"></a>
</h4>
<p>Any <code>numeric</code> or <code>POSIXct</code> column (in X or Y dimension) can be used to visualize time series. Use the <code>Toggle Lines</code> button above the plot to facilitate exploration.</p>
<p><strong>Example 1</strong>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">treering</span><span class="op">)</span></span>
<span><span class="va">tree_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="op">-</span><span class="fl">6000</span><span class="op">:</span><span class="fl">1979</span>,</span>
<span>           val <span class="op">=</span> <span class="va">treering</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make synthetic data</span></span>
<span><span class="va">tree_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tree_A <span class="op">=</span> <span class="va">tree_df</span>,</span>
<span>                  tree_B <span class="op">=</span> <span class="va">tree_df</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>                      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>val <span class="op">=</span> <span class="va">val</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  tree_C <span class="op">=</span> <span class="va">tree_df</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>                      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>val <span class="op">=</span> <span class="va">val</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, mean <span class="op">=</span> <span class="op">-</span><span class="fl">0.03</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"tree"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># group by tree and inspect</span></span>
<span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="va">tree_data</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>(Note, selections are arbitrary and for demonstration only)</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/the-Hull/datacleanr/master/man/figures/readme_select_timeseries.gif" width="1000" align="center"></p>
<p><strong>Example 2</strong>:</p>
<blockquote>
<p>No GIF</p>
</blockquote>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"storms"</span>, package <span class="op">=</span> <span class="st">"dplyr"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">storms_mod</span> <span class="op">&lt;-</span> <span class="va">storms</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>timestamp <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_h</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span>, <span class="va">hour</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group by name (198 groups)</span></span>
<span><span class="co"># Check "Emily"</span></span>
<span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="va">storms_mod</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="id_34-spatial">3.4 Spatial<a class="anchor" aria-label="anchor" href="#id_34-spatial"></a>
</h4>
<p>Interactive maps rely on <a href="https://www.mapbox.com/" class="external-link">Mapbox</a> for plotting. Therefore, you will need to make an account, from which an access token needs to be copied into your <code>.Renviron</code> (e.g. <code>MAPBOX_TOKEN=your_copied_token</code>). A simple way to do this is using the convenient <code>usethis</code> package to access the file:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu">edit_r_environ</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Select columns <code>lon</code> and <code>lat</code> for plotting to get started.</p>
<p><strong>Example 1</strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/the-Hull/datacleanr" class="external-link">datacleanr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">airport_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">'https://plotly-r.com/data-raw/airport_locations.csv'</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="va">long</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># group by state</span></span>
<span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="va">airport_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/the-Hull/datacleanr/master/man/figures/readme_select_spatial.gif" width="1000" align="center"></p>
<p><strong>Example 2</strong></p>
<blockquote>
<p>No GIF</p>
</blockquote>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"storms"</span>, package <span class="op">=</span> <span class="st">"dplyr"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">storms_mod</span> <span class="op">&lt;-</span> <span class="va">storms</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="va">long</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group by name (198 groups)</span></span>
<span><span class="co"># Check "Bonnie"</span></span>
<span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="va">storms_mod</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="id_4-extract-reproducible-recipe">4. Extract (Reproducible Recipe)<a class="anchor" aria-label="anchor" href="#id_4-extract-reproducible-recipe"></a>
</h3>
<p>All grouping, filtering and selections/annotations are translated to <code>R</code> code, which can be sent to an <code>RStudio</code> script, copied to the clipboard, or - when <code>dcr_app</code> is launched with a file path - save options are made available. For large selections/annotations we recommend saving the script separately, and sourcing it (i.e. <code>source("your_datacleanr_script.R")</code>) during later analyses.</p>
<p><strong>Caution: When selections / annotations are greater than ~ 1000 points, it is recommended to use <code>datacleanr</code> with an <code>*.RDS</code> file (see below). This is because the resulting Reproducible Recipe (script) can slow down the RStudio IDE, if it has more than a few thousand lines.The next version of <code>datacleanr</code> will allow choosing between script-only recipes, and the option with an the intermediate file for storing annotations. Both approaches with their current implementation are shown shown below.</strong></p>
<p><strong>Example 1</strong></p>
<p>Launching with an object from <code>R</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/the-Hull/datacleanr" class="external-link">datacleanr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/the-Hull/datacleanr/master/man/figures/readme_extract.gif" width="1000" align="center"></p>
<p>And output from extract tab:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># datacleaning with datacleanr (0.0.1)</span></span>
<span><span class="co"># ##------ Wed Oct 07 12:54:03 2020 ------##</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/the-Hull/datacleanr" class="external-link">datacleanr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  adding column for unique IDs;</span></span>
<span><span class="va">iris</span><span class="op">$</span><span class="va">.dcrkey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">iris</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">iris</span>, <span class="va">Species</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  stats and scoping level for filtering</span></span>
<span><span class="va">filter_conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>filter <span class="op">=</span> <span class="st">"Sepal.Width &gt; 2.7"</span>, grouping <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, </span>
<span>    <span class="op">-</span><span class="fl">1L</span><span class="op">)</span>, class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tbl_df"</span>, <span class="st">"tbl"</span>, <span class="st">"data.frame"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  applying (scoped) filtering by groups;</span></span>
<span><span class="va">iris</span> <span class="op">&lt;-</span> <span class="fu">datacleanr</span><span class="fu">::</span><span class="fu"><a href="reference/filter_scoped_df.html">filter_scoped_df</a></span><span class="op">(</span>dframe <span class="op">=</span> <span class="va">iris</span>, condition_df <span class="op">=</span> <span class="va">filter_conditions</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  observations from manual selection (Viz tab);</span></span>
<span><span class="va">iris_outlier_selection</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.dcrkey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15L</span>, <span class="fl">16L</span>, <span class="fl">19L</span>, <span class="fl">34L</span><span class="op">)</span>, .annotation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>, </span>
<span>    <span class="st">""</span><span class="op">)</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"data.frame"</span>, row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="op">-</span><span class="fl">4L</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  create data set with annotation column (non-outliers are NA);</span></span>
<span><span class="va">iris</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">iris</span>, <span class="va">iris_outlier_selection</span>, by <span class="op">=</span> <span class="st">".dcrkey"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove comment below to drop manually selected obs in data set;</span></span>
<span><span class="co"># iris  &lt;- iris %&gt;% dplyr::filter(is.na(.annotation))</span></span></code></pre></div>
<p><strong>Example 2</strong></p>
<p>Launching with an <code>.RDS</code> from disk:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="st">"./testiris.Rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/the-Hull/datacleanr" class="external-link">datacleanr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="st">"./testiris.Rds"</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/the-Hull/datacleanr/master/man/figures/readme_extract_file.gif" width="1000" align="center"></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples:<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="id_1-exploring-soil-respiration-with-cosore">1. Exploring soil respiration with <strong>COSORE</strong>:<a class="anchor" aria-label="anchor" href="#id_1-exploring-soil-respiration-with-cosore"></a>
</h3>
<p><strong>COSORE</strong> is a community-driven soil respiration database, recently introduced with a manuscript published <a href="https://doi.org/10.1111/gcb.15353" class="external-link">here</a> by Bond-Lamberty <em>et al.</em>. The database provides soil respiration flux estimates, as well as meta data across multiple data sets. Let’s explore!</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"bpbond/cosore"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check data base info</span></span>
<span><span class="va">db_info</span> <span class="op">&lt;-</span> <span class="fu">cosore</span><span class="fu">::</span><span class="fu">csr_database</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">db_info</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># grab one data set and explore in detail</span></span>
<span><span class="va">dset</span> <span class="op">&lt;-</span> <span class="st">"d20190409_ANJILELI"</span></span>
<span><span class="va">anjilleli</span> <span class="op">&lt;-</span> <span class="fu">cosore</span><span class="fu">::</span><span class="fu">csr_dataset</span><span class="op">(</span><span class="va">dset</span><span class="op">)</span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">anjilleli</span><span class="op">$</span><span class="va">description</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">datacleanr</span><span class="fu">::</span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="va">anjilleli</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/the-Hull/datacleanr/master/man/figures/readme_cosore_single.gif" width="1000" align="center"></p>
<p><strong>Explore sampling locations</strong>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check location info</span></span>
<span><span class="va">db_info</span> <span class="op">&lt;-</span> <span class="va">db_info</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="va">CSR_LONGITUDE</span>,</span>
<span>           lat <span class="op">=</span> <span class="va">CSR_LATITUDE</span><span class="op">)</span></span>
<span><span class="fu">datacleanr</span><span class="fu">::</span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="va">db_info</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>No GIF</p>
</blockquote>
<p><strong>Explore nested data sets</strong>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># grab all data from ZHANG</span></span>
<span><span class="va">zhang</span> <span class="op">&lt;-</span> <span class="fu">cosore</span><span class="fu">::</span><span class="fu">csr_table</span><span class="op">(</span><span class="st">"data"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d20190424_ZHANG_maple"</span>,</span>
<span>                                        <span class="st">"d20190424_ZHANG_oak"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># adjust for grouping</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>CSR_PORT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">CSR_PORT</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># group by CSR_DATASET and CSR_PORT</span></span>
<span><span class="fu">datacleanr</span><span class="fu">::</span><span class="fu"><a href="reference/dcr_app.html">dcr_app</a></span><span class="op">(</span><span class="va">zhang</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://raw.githubusercontent.com/the-Hull/datacleanr/master/man/figures/readme_cosore.gif" width="1000" align="center"></p>
<hr>
<p>Please note that the <code>datacleanr</code> project is released with a <a href="https://raw.githubusercontent.com/the-Hull/datacleanr/master/.github/CODE_OF_CONDUCT.md" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=datacleanr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/the-Hull/datacleanr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/the-Hull/datacleanr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
<li><a href="SUPPORT.html">Getting help</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing datacleanr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Alexander Hurley <br><small class="roles"> Maintainer, author, copyright holder </small> <a href="https://orcid.org/0000-0002-9641-2805" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://app.circleci.com/pipelines/github/the-Hull/datacleanr" class="external-link"><img src="https://circleci.com/gh/Appsilon/ci.example.svg?style=svg" alt="CircleCI"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html" class="external-link"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="Lifecycle: maturing"></a></li>
<li><a href="https://cran.r-project.org/package=datacleanr" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/datacleanr"></a></li>
<li><a href="https://cran.r-project.org/package=datacleanr" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/datacleanr?color=brightgreen"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Hurley.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
